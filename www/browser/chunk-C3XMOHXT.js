import{b as U}from"./chunk-IIKFY65W.js";import{L as e,M as y,N as I,O as L,P as p,Q as S,R as N,S as q,U as w,Y as j,Z as F,aa as R,d as b,i as l,j as c,k as u,l as h,la as T,m as i,ma as A,n as o,o as m,q as x,r as C,s as g,t as _,va as G,wa as M,y as E}from"./chunk-NUXSCCIY.js";import{f as v}from"./chunk-MIURFOFH.js";function V(n,a){n&1&&(i(0,"p"),g(1,"Perfil es requerido."),o())}function D(n,a){n&1&&(i(0,"p"),g(1,"Perfil debe ser 1 (docente) o 2 (alumno)."),o())}function P(n,a){if(n&1&&(i(0,"div"),h(1,V,2,0,"p",5)(2,D,2,0,"p",5),o()),n&2){let f=C(),r,t;l(1),u("ngIf",(r=f.usuario.get("perfil"))==null||r.errors==null?null:r.errors.required),l(1),u("ngIf",((t=f.usuario.get("perfil"))==null||t.errors==null?null:t.errors.min)||((t=f.usuario.get("perfil"))==null||t.errors==null?null:t.errors.max))}}var K=(()=>{let a=class a{constructor(r,t,s,d){this.modalController=r,this.consumoapi=t,this.fb=s,this.alertController=d,this.usuario=new L({user:new p("",[e.required,e.minLength(4),e.maxLength(10)]),pass:new p("",[e.required,e.minLength(5),e.maxLength(20)]),nombre:new p("",[e.required,e.minLength(5),e.maxLength(20)]),correo:new p("",[e.required,e.minLength(10),e.maxLength(30)]),perfil:new p("",[e.required,e.minLength(1),e.maxLength(2),this.esEntero])}),this.mensaje=""}esEntero(r){return Number.isInteger(r.value)?null:{noEsEntero:!0}}registrar(){this.consumoapi.registrarUsuario(this.usuario.value.user,this.usuario.value.pass,this.usuario.value.nombre,Number(this.usuario.value.perfil),this.usuario.value.correo).subscribe(r=>{r.status==201?(this.mostrarAlerta("Usuario registrado con \xE9xito!"),console.log("Usuario registrado con \xE9xito:",r.body)):(this.mensaje="Error al registrar al usuario",console.error("Error al registrar al usuario:",r.status))},r=>{r.status===400&&r.error.message==="El nombre de usuario ya est\xE1 en uso"?this.mensaje="El nombre de usuario ya est\xE1 en uso":this.mensaje="Error en el registro",console.error("Error al registrar al usuario:",r)})}mostrarAlerta(r){return v(this,null,function*(){yield(yield this.alertController.create({header:"Registro",message:r,buttons:[{text:"Ingresar sesi\xF3n",handler:()=>{this.cerrarModal(),this.modalController.dismiss({registrado:!0})}}]})).present()})}cerrarModal(){this.modalController.dismiss({dismissed:!0,user:this.usuario.value.user,pass:this.usuario.value.pass,nombre:this.usuario.value.nombre,perfil:this.usuario.value.perfil,correo:this.usuario.value.correo})}ngOnInit(){this.usuario=this.fb.group({user:["",[e.required,e.minLength(4),e.maxLength(10)]],pass:["",[e.required,e.minLength(5),e.maxLength(20)]],correo:["",[e.required,e.minLength(10),e.maxLength(30)]],nombre:["",[e.required,e.minLength(5),e.maxLength(20)]],perfil:["",[e.required,e.min(1),e.max(2)]]})}};a.\u0275fac=function(t){return new(t||a)(c(M),c(U),c(w),c(G))},a.\u0275cmp=b({type:a,selectors:[["app-registro"]],decls:16,vars:4,consts:[[3,"formGroup","ngSubmit"],["label","Usuario","type","text","formControlName","user"],["label","Contrase\xF1a","type","password","formControlName","pass"],["label","Nombre","type","text","formControlName","nombre"],["label","Perfil","type","number","formControlName","perfil"],[4,"ngIf"],["label","Email","type","email","formControlName","correo"],["type","submit","expand","full",3,"disabled"]],template:function(t,s){if(t&1&&(i(0,"form",0),x("ngSubmit",function(){return s.registrar()}),i(1,"ion-item"),m(2,"ion-input",1),o(),i(3,"ion-item"),m(4,"ion-input",2),o(),i(5,"ion-item"),m(6,"ion-input",3),o(),i(7,"ion-item"),m(8,"ion-input",4),o(),h(9,P,3,2,"div",5),i(10,"ion-item"),m(11,"ion-input",6),o(),i(12,"ion-button",7),g(13,"Registrar"),o(),i(14,"p"),g(15),o()()),t&2){let d;u("formGroup",s.usuario),l(9),u("ngIf",(d=s.usuario.get("perfil"))==null?null:d.errors),l(3),u("disabled",!s.usuario.valid),l(3),_(s.mensaje)}},dependencies:[E,R,T,A,j,F,S,y,I,N,q]});let n=a;return n})();export{K as a};
